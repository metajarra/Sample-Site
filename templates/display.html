<!DOCTYPE html>

<style>
    .center-screen {
        display: flex;
        justify-content: center;
        align-items: center;
        text-align: center;
        min-height: 100vh;
    }

    p {
        font-size: larger;
        color: aliceblue;
        margin: 1%;
    }

    button {
        font-size: larger;
        color: aliceblue;
        background-color: darkcyan;
        margin: 1%;
    }

    div {
        background-color: lightblue;
    }
</style>

<div class="center-screen" id="maindiv">
    <form method="/POST">
        {% if content %}
            
            <script>
                let markers = "{{ content }}";
                let index = "{{ index }}";
                let breaks = [];
                let newbreaks = [];

                let text = "";
                let lat = "";
                let long = "";

                let result = markers.indexOf(index) - 1;
                
                console.log(markers);
                console.log(index);

                for(let i = 0; i < markers.length; i++){
                    if(markers.charAt(i) == "|"){
                        breaks.push(i);
                    }

                    else if(markers.charAt(i) == "/"){
                        newbreaks.push(i);
                    }
                }

                for(let i = 0; i < newbreaks.length; i++){
                    for(let j = 0; j < 3; j++){
                        if(j % 3 == 0){
                            console.log("SERIAL: " + markers.substring(newbreaks[i] + 1, breaks[j + (3 * i)]));
                        }

                        else if((j - 1) % 3 == 0){
                            console.log("TEXT: " + markers.substring(breaks[j - 1 + (3 * i)] + 1, breaks[j + (3 * i)]));
                            text = markers.substring(breaks[j - 1 + (3 * i)] + 1, breaks[j + (3 * i)]);
                        }

                        else if((j - 2) % 3 == 0){
                            console.log("LATITUDE: " + markers.substring(breaks[j - 1 + (3 * i)] + 1, breaks[j + (3 * i)]));
                            lat = parseInt(markers.substring(breaks[j - 1 + (3 * i)] + 1, breaks[j + (3 * i)]));
                                    
                            if(i < newbreaks.length){
                                console.log("LONGITUDE: " + markers.substring(breaks[j + (3 * i)] + 1, newbreaks[i + 1]));
                                long = parseInt(markers.substring(breaks[j + (3 * i)] + 1, newbreaks[i + 1]));
                            }

                            else{
                                console.log("LONGITUDE: " + markers.substring(breaks[j + (3 * i)] + 1, markers.length()));
                                long = parseInt(markers.substring(breaks[j + (3 * i)] + 1, markers.length()));
                            }
                                    
                            console.log("------");
                        }
                    }
                }

                text = markers.substring(breaks[0] + 1, breaks[1]);
                lat = markers.substring(breaks[1], breaks[2]);
                long = markers.substring(breaks[2], newbreaks[0]);

                const textpara = document.createElement("p");
                const latpara = document.createElement("p");
                const longpara = document.createElement("p");

                textpara.innerHTML = text;
                latpara.innerHTML = lat;
                longpara.innerHTML = long;

                document.getElementById("maindiv").appendChild(textpara);
                document.getElementById("maindiv").appendChild(latpara);
                document.getElementById("maindiv").appendChild(longpara);
            </script>

        {% endif %}
    </form>
</div>